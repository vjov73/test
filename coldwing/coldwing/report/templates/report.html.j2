<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Coldwing Report {{ results.job_id }}</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<h1>Coldwing External Exposure Report</h1>

<div class="meta">
  <strong>Target:</strong> {{ results.target }}<br/>
  <strong>Profile:</strong> {{ results.profile }}<br/>
  <strong>Job ID:</strong> {{ results.job_id }}<br/>
  <strong>Status:</strong> {{ results.status }}<br/>
  <strong>Started:</strong> {{ results.started_at }}<br/>
  <strong>Completed:</strong> {{ results.completed_at }}
</div>

<hr/>

<h2>Executive Summary</h2>
<ul>
  <li>DNS records found: {{ results.dns.records | length if results.dns and results.dns.records else 0 }}</li>
  <li>Subdomains discovered: {{ results.subdomains.subdomains | length if results.subdomains and results.subdomains.subdomains else 0 }}</li>
  <li>SSL valid: {{ "Yes" if results.ssl.valid else "No" }}</li>
  <li>Email SPF: {{ results.email_security.spf }}</li>
  <li>Email DMARC: {{ results.email_security.dmarc }}</li>
</ul>

<hr/>

<h2>DNS</h2>
{% if results.dns %}
  {% for record_type, values in results.dns.records.items() %}
    <strong>{{ record_type }}</strong>
    <ul>
      {% for v in values %}
        <li>{{ v }}</li>
      {% endfor %}
    </ul>
  {% endfor %}
{% else %}
  <p>No DNS data available.</p>
{% endif %}

<hr/>

<h2>Subdomains</h2>
{% if results.subdomains and results.subdomains.subdomains %}
  <ul>
    {% for sub in results.subdomains.subdomains %}
      <li>{{ sub }}</li>
    {% endfor %}
  </ul>
{% else %}
  <p>No subdomains discovered.</p>
{% endif %}

<hr/>

<h2>Hosting</h2>
{% if results.hosting %}
  <ul>
    <li>ASN: {{ results.hosting.asn }}</li>
    <li>Provider: {{ results.hosting.provider }}</li>
  </ul>
{% endif %}

<hr/>

<h2>SSL / TLS</h2>
{% if results.ssl %}
  <ul>
    <li>Valid: {{ results.ssl.valid }}</li>
    <li>TLS Version: {{ results.ssl.tls }}</li>
  </ul>
{% endif %}

<hr/>

<h2>Technology Stack</h2>
{% if results.tech and results.tech.stack %}
  <ul>
    {% for tech in results.tech.stack %}
      <li>{{ tech }}</li>
    {% endfor %}
  </ul>
{% else %}
  <p>No technology fingerprint available.</p>
{% endif %}

<hr/>

<h2>Email Security</h2>
{% if results.email_security %}
  <ul>
    <li>SPF: {{ results.email_security.spf }}</li>
    <li>DMARC: {{ results.email_security.dmarc }}</li>
    <li>DKIM: {{ results.email_security.dkim }}</li>
  </ul>
{% endif %}

<hr/>

<footer>
  <small>
    Generated by Coldwing Scanner Platform | Tenant: {{ results.tenant_id }}
  </small>
</footer>

</body>
</html>
